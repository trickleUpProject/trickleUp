<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>dc experiments - dimensional charting</title>

    <script type="text/javascript" src="../js/mbostock-d3-44e4620/d3.v2.js"></script>
    <script type="text/javascript" src="../js/square-crossfilter-0a7bf20/crossfilter.js"></script>
    <script type="text/javascript" src="../js/NickQiZhu-dc.js-ce8bc87/dc.js"></script>

    <link rel="stylesheet" type="text/css" href="../js/NickQiZhu-dc.js-ce8bc87/test/dc.css"/>

</head>
<body>

<center>
    <h3>dc experiments (dimensional charting)</h3>
</center>


<div id="livestockByMonth-chart" >
    <span>Livestock By Month</span>
    Current filter: <span class="filter"></span>
    <a class="reset" href="javascript:livestockByMonthChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>
    <div class="clear"></div>
</div>

<div class="clear"></div>

<div id="livestockByBiz-chart" >
    <span>Livestock By Biz</span>
    <a class="reset" href="javascript:livestockByBizChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>
    <div class="clear"></div>
</div>


<script type="text/javascript">

var livestockByMonthChart = dc.barChart("#livestockByMonth-chart");
var livestockByBizChart = dc.barChart("#livestockByBiz-chart");

/*
var gainOrLossChart = dc.pieChart("#gain-loss-chart");
*/

            var data = [
                {
                    bizId: 1, 
                    livestockType: 'pig',
                    month: 1
                },
                {
                    bizId: 1, 
                    livestockType: 'pig',
                    month: 1
                },
                {
                    bizId: 1, 
                    livestockType: 'pig',
                    month: 2
                },
                {
                    bizId: 1, 
                    livestockType: 'pig',
                    month: 2
                },
                {
                    bizId: 1, 
                    livestockType: 'pig',
                    month: 2
                },
                {
                    bizId: 2, 
                    livestockType: 'pig',
                    month: 3
                },
                {
                    bizId: 2, 
                    livestockType: 'pig',
                    month: 3
                }
            ];
            
            // feed it through crossfilter
            var ndx = crossfilter(data);
            var all = ndx.groupAll();
            
            var byMonth = ndx.dimension(function(d) {
                return d.month;
            });
            
            var byMonthGroup = byMonth.group();

            livestockByMonthChart.width(420)
                .height(180)
                .margins({top: 10, right: 50, bottom: 30, left: 40})
                .dimension(byMonth)
                .group(byMonthGroup)
                .elasticY(true)
                .centerBar(true)
                .gap(1)
                .round(dc.round.floor)
                .x(d3.scale.linear().domain([0, 12]))
                .renderHorizontalGridLines(true)
                //.brushOn(false)
                .xAxis()
                .tickFormat(function(v) {
                        return v;
                    });
            livestockByMonthChart.yAxis().tickFormat(function(v) {return v;});
            
            livestockByMonthChart.renderlet(function(chart){
                //chart.select("g.y").style("display", "none");
                livestockByBizChart.filter(chart.filter());
            });
            
            
            var byBiz = ndx.dimension(function(d) {
                return d.bizId;
            });
            
            var byBizGroup = byBiz.group();

            livestockByBizChart.width(420)
                .height(180)
                .margins({top: 10, right: 50, bottom: 30, left: 40})
                .dimension(byBiz)
                .group(byBizGroup)
                .elasticY(true)
                .centerBar(true)
                .gap(1)
                .round(dc.round.floor)
                .x(d3.scale.linear().domain([0, 12]))
                .renderHorizontalGridLines(true)
                //.brushOn(false)
                .xAxis()
                .tickFormat(function(v) {
                        return v;
                    });
            livestockByBizChart.yAxis().tickFormat(function(v) {return v;});
            
            
            dc.renderAll();

</script>

</body>
</html>